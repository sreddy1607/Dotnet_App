[Pipeline] stage
[Pipeline] { (Auto-Detect Items & Create Label)
[Pipeline] container
[Pipeline] {
[Pipeline] sh
13:38:02  + set -e
13:38:02  + cd MotioCI/api/CLI
13:38:02  ++ cat ../token.txt
13:38:02  + TOKEN=8d25778b-f1c3-44b5-b599-dc2a69bca9f3
13:38:02  + echo 'Discovering versioned item IDs under: /Team Content/MotioCI Reports/Testing/Test Results Detail'
13:38:02  Discovering versioned item IDs under: /Team Content/MotioCI Reports/Testing/Test Results Detail
13:38:02  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov versionedItems ls --xauthtoken 8d25778b-f1c3-44b5-b599-dc2a69bca9f3 --instanceName Cognos-DEV/TEST --projectName Demo --searchPath 'starts:/Team Content/MotioCI Reports/Testing/Test Results Detail'
13:38:02  + grep ''\''id'\'':' items.out
13:38:02  + grep -v instanceId
13:38:02  + grep -o '[0-9][0-9]*'
13:38:02  + paste -sd, -
13:38:02  ++ cat ids.txt
13:38:02  + IDS=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,18106,18107,18108,18109,18110,18111,18112,18113,18114,18115,18116,18117,18118,18119,18120,18121,18122,18123,18124,18125,18126,18127,18128,18129,18130,18131,18132,18133,18134,18135,18136,18137,18138,18139,18140,18141,18142,18143,18144,18145,18146,18147,18148,18149,18150,18151,18152,18153,18154,18155
13:38:02  + '[' -z 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,18106,18107,18108,18109,18110,18111,18112,18113,18114,18115,18116,18117,18118,18119,18120,18121,18122,18123,18124,18125,18126,18127,18128,18129,18130,18131,18132,18133,18134,18135,18136,18137,18138,18139,18140,18141,18142,18143,18144,18145,18146,18147,18148,18149,18150,18151,18152,18153,18154,18155 ']'
13:38:02  + '[' true = true ']'
13:38:02  ++ date +%Y%m%d_%H%M
13:38:02  + PRE_LABEL=PreDeploy_66_20251107_2138
13:38:02  + echo 'Creating Pre-Deployment Label: PreDeploy_66_20251107_2138'
13:38:02  Creating Pre-Deployment Label: PreDeploy_66_20251107_2138
13:38:02  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov label create --xauthtoken 8d25778b-f1c3-44b5-b599-dc2a69bca9f3 --instanceName Cognos-DEV/TEST --projectName Demo --name PreDeploy_66_20251107_2138
13:38:03  DEBUG: Creating label with project_id=17, label_name=PreDeploy_66_20251107_2138
13:38:03  DEBUG: Variables: {'projectId': 17, 'name': 'PreDeploy_66_20251107_2138', 'versionedItemSource': {'ids': []}}
13:38:03  DEBUG: Create label response status: 200
13:38:03  DEBUG: Create label response text: {"data":{"createLabel":{"name":"PreDeploy_66_20251107_2138","description":null,"id":128}}}
13:38:03  DEBUG: Successfully created label with ID: 128
13:38:03  Label Created!
13:38:03  ++ date +%Y%m%d_%H%M
13:38:03  + VERSION_NAME=AutoLabel_66_20251107_2138
13:38:03  + echo 'Creating Deployment Label: AutoLabel_66_20251107_2138 with IDs [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,18106,18107,18108,18109,18110,18111,18112,18113,18114,18115,18116,18117,18118,18119,18120,18121,18122,18123,18124,18125,18126,18127,18128,18129,18130,18131,18132,18133,18134,18135,18136,18137,18138,18139,18140,18141,18142,18143,18144,18145,18146,18147,18148,18149,18150,18151,18152,18153,18154,18155]'
13:38:03  Creating Deployment Label: AutoLabel_66_20251107_2138 with IDs [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,18106,18107,18108,18109,18110,18111,18112,18113,18114,18115,18116,18117,18118,18119,18120,18121,18122,18123,18124,18125,18126,18127,18128,18129,18130,18131,18132,18133,18134,18135,18136,18137,18138,18139,18140,18141,18142,18143,18144,18145,18146,18147,18148,18149,18150,18151,18152,18153,18154,18155]
13:38:03  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov label create --xauthtoken 8d25778b-f1c3-44b5-b599-dc2a69bca9f3 --instanceName Cognos-DEV/TEST --projectName Demo --name AutoLabel_66_20251107_2138 --versionedItemIds '[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,18106,18107,18108,18109,18110,18111,18112,18113,18114,18115,18116,18117,18118,18119,18120,18121,18122,18123,18124,18125,18126,18127,18128,18129,18130,18131,18132,18133,18134,18135,18136,18137,18138,18139,18140,18141,18142,18143,18144,18145,18146,18147,18148,18149,18150,18151,18152,18153,18154,18155]'
13:38:04  DEBUG: Creating label with project_id=17, label_name=AutoLabel_66_20251107_2138
13:38:04  DEBUG: Variables: {'projectId': 17, 'name': 'AutoLabel_66_20251107_2138', 'versionedItemSource': {'ids': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 18106, 18107, 18108, 18109, 18110, 18111, 18112, 18113, 18114, 18115, 18116, 18117, 18118, 18119, 18120, 18121, 18122, 18123, 18124, 18125, 18126, 18127, 18128, 18129, 18130, 18131, 18132, 18133, 18134, 18135, 18136, 18137, 18138, 18139, 18140, 18141, 18142, 18143, 18144, 18145, 18146, 18147, 18148, 18149, 18150, 18151, 18152, 18153, 18154, 18155]}}
13:38:04  DEBUG: Create label response status: 200
13:38:04  DEBUG: Create label response text: {"data":{"createLabel":{"name":"AutoLabel_66_20251107_2138","description":null,"id":129}}}
13:38:04  DEBUG: Successfully created label with ID: 129
13:38:04  Label Created!
13:38:04  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov label ls --xauthtoken 8d25778b-f1c3-44b5-b599-dc2a69bca9f3 --instanceName Cognos-DEV/TEST --projectName Demo --labelName AutoLabel_66_20251107_2138
13:38:04  ++ python3 -c 'import ast; data=open('\''label_info.out'\'').read(); parsed=ast.literal_eval(data); print(parsed['\''data'\'']['\''instances'\'']['\''edges'\''][0]['\''node'\'']['\''projects'\'']['\''edges'\''][0]['\''node'\'']['\''labels'\'']['\''edges'\''][0]['\''node'\'']['\''id'\''])'
13:38:04  + LABEL_ID=129
13:38:04  + echo 129
13:38:04  + echo 'Label AutoLabel_66_20251107_2138 (ID: 129) created successfully.'
13:38:04  Label AutoLabel_66_20251107_2138 (ID: 129) created successfully.
[Pipeline] }
[Pipeline] // container
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Retrieve CAMPassport & Deploy)
[Pipeline] container
[Pipeline] {
[Pipeline] withCredentials
13:38:04  Masking supported pattern matches of $COGNOS_API_KEY_PRD
[Pipeline] {
[Pipeline] sh
13:38:05  + set -e
13:38:05  + cd MotioCI/api/CLI
13:38:05  + '[' -n '' ']'
13:38:05  ++ cat ../token.txt
13:38:05  + TOKEN=8d25778b-f1c3-44b5-b599-dc2a69bca9f3
13:38:05  + echo 'Obtaining PROD CAMPassport...'
13:38:05  Obtaining PROD CAMPassport...
13:38:05  + BASE=https://dhcsprodcognos.ca.analytics.ibm.com/api/v1
13:38:05  + echo '{"parameters":[{"name":"CAMAPILoginKey","value":"****"}]}'
13:38:05  + curl -sS -X PUT https://dhcsprodcognos.ca.analytics.ibm.com/api/v1/session -H 'Content-Type: application/json' -d @login.json -o session.json
13:38:05  ++ python3 -c 'import json; print(json.load(open("session.json")).get("session_key",""))'
13:38:05  + SESSION_KEY='CAM MTsxMDE6ZTU2Y2ZmZDItYjBjNC00MzczLTE2MTktYTllNTNjZjdkMmY2OjIyNzMzNDU3MzM7MDszOzA7'
13:38:05  ++ echo 'CAM MTsxMDE6ZTU2Y2ZmZDItYjBjNC00MzczLTE2MTktYTllNTNjZjdkMmY2OjIyNzMzNDU3MzM7MDszOzA7'
13:38:05  ++ sed 's/^CAM[ ]*//'
13:38:05  + SESSION_KEY=MTsxMDE6ZTU2Y2ZmZDItYjBjNC00MzczLTE2MTktYTllNTNjZjdkMmY2OjIyNzMzNDU3MzM7MDszOzA7
13:38:05  + echo '✓ CAMPassport captured'
13:38:05  ✓ CAMPassport captured
13:38:05  + '[' -n '' ']'
13:38:05  ++ cat ../label_id.txt
13:38:05  + LABEL_ID=129
13:38:05  + LABEL_NAME=
13:38:05  + DEPLOY_LABEL_NAME=PROMOTED_66
13:38:05  + echo 'Deploying to Cognos-PRD...'
13:38:05  Deploying to Cognos-PRD...
13:38:05  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov deploy --xauthtoken 8d25778b-f1c3-44b5-b599-dc2a69bca9f3 --sourceInstanceName Cognos-DEV/TEST --targetInstanceName Cognos-PRD --projectName Demo --labelId 129 --targetLabelName PROMOTED_66 --camPassportId MTsxMDE6ZTU2Y2ZmZDItYjBjNC00MzczLTE2MTktYTllNTNjZjdkMmY2OjIyNzMzNDU3MzM7MDszOzA7
13:39:13  + cat deploy.out
13:39:13  deploymentID: 57
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: RUNNING
13:39:13  deployment result: EXECUTED
13:39:13  Deployed!
13:39:13  + grep -q '"errors"' deploy.out
13:39:13  + echo 'Deployment executed successfully.'
13:39:13  Deployment executed successfully.
[Pipeline] }
[Pipeline] // withCredentials
[Pipeline] }
[Pipeline] // container
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Declarative: Post Actions)
[Pipeline] echo
13:39:13  Pipeline execution finished.
[Pipeline] echo
13:39:13  MotioCI pipeline completed successfully.
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // timestamps
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] }
[Pipeline] // podTemplate
[Pipeline] End of Pipeline
/var/lib/jenkins/jobs/Cognos Jobs/workspace/testing@tmp/jfrog/66/.jfrog deleted
Finished: SUCCESS
