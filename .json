[Pipeline] container
[Pipeline] {
[Pipeline] sh
13:16:16  + echo 'Checking available namespaces for PRD instance...'
13:16:16  Checking available namespaces for PRD instance...
13:16:16  + curl -sk -X POST https://cgrptmcip01.cloud.cammis.ca.gov/api/graphql -H 'Content-Type: application/json' -H 'x-auth-token: d5050ddc-6d27-40c7-8965-bb3e4c9f01da' -d '{
13:16:16              "query":"query($id: Long!){ instance(id:$id){ namespaces { id name } } }",
13:16:16              "variables":{"id":1}
13:16:16            }'
13:16:16  + jq .
13:16:16  {
13:16:16    "data": {
13:16:16      "instance": {
13:16:16        "namespaces": [
13:16:16          {
13:16:16            "id": "BAOps",
13:16:16            "name": "BAOps"
13:16:16          },
13:16:16          {
13:16:16            "id": "LDAP",
13:16:16            "name": "LDAP"
13:16:16          },
13:16:16          {
13:16:16            "id": "AzureAD",
13:16:16            "name": "Azure"
13:16:16          }
13:16:16        ]
13:16:16      }
13:16:16    }
13:16:16  }
[Pipeline] }
[Pipeline] // container
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Deploy)
[Pipeline] withCredentials
13:16:17  Masking supported pattern matches of $COG_USER or $COG_PASS
[Pipeline] {
[Pipeline] container
[Pipeline] {
[Pipeline] sh
13:16:17  + set -euo pipefail
13:16:17  + cd MotioCI/api/CLI
13:16:17  + echo 'Sanity: list projects on Cognos-PRD...'
13:16:17  Sanity: list projects on Cognos-PRD...
13:16:17  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov project ls --xauthtoken=d5050ddc-6d27-40c7-8965-bb3e4c9f01da --instanceName=Cognos-PRD
13:16:17  {'node': {'id': 1, 'name': 'Admin', 'description': None}}
13:16:17  {'node': {'id': 13, 'name': 'Deployments', 'description': None}}
13:16:17  {'node': {'id': 18, 'name': 'Demo', 'description': None}}
13:16:17  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov --non-interactive deploy --xauthtoken=d5050ddc-6d27-40c7-8965-bb3e4c9f01da --sourceInstanceId=3 --targetInstanceId=1 --labelId=57 --projectName=Demo --targetLabelName=PROMOTED-20250712-115 --username=**** --password=**** --namespaceId=AzureAD
13:16:20  Error performing the deployment:
13:16:20    [{'message': 'Access is denied', 'locations': [{'line': 3, 'column': 5}], 'path': ['deploy'], 'extensions': {'code': 'ACCESS_DENIED', 'isLicenseValid': True, 'classification': 'DataFetchingException'}}]
13:16:20  + echo 'Verification: labels after deployment'
13:16:20  Verification: labels after deployment
13:16:20  + python3 ci-cli.py --server=https://cgrptmcip01.cloud.cammis.ca.gov label ls --xauthtoken=d5050ddc-6d27-40c7-8965-bb3e4c9f01da --instanceName=Cognos-PRD --projectName=Demo
13:16:20  + tee verify_labels.json
13:16:20  {'node': {'name': 'Pre-Promotion Label for motioci-poc-101', 'id': 58, 'description': '', 'labelType': 'PRE_DEPLOYMENT'}}
13:16:20  {'node': {'name': 'motioci-poc-101', 'id': 59, 'description': None, 'labelType': 'POST_DEPLOYMENT'}}
[Pipeline] }
[Pipeline] // container
[Pipeline] }
[Pipeline] // withCredentials
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Declarative: Post Actions)
[Pipeline] echo
13:16:20  Pipeline execution finished.
